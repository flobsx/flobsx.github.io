"use strict";(self.webpackChunkpersonal_blog=self.webpackChunkpersonal_blog||[]).push([[337],{1145:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>u});var t=s(5893),i=s(1151);const o={title:"Blog personnel avec Docusaurus, Github Pages + Actions",authors:"flobsx",tags:["docusaurus","github"]},l=void 0,r={permalink:"/blog/blog/2024/01/16/docusaurus-setup-github-pages",editUrl:"https://github.com/flobsx/personal-blog/tree/main/blog/2024-01-16-docusaurus-setup-github-pages/index.md",source:"@site/blog/2024-01-16-docusaurus-setup-github-pages/index.md",title:"Blog personnel avec Docusaurus, Github Pages + Actions",description:"L'objectif est de publier un blog sur Github Pages en utilisant Docusaurus et un d\xe9ploiement automatique.",date:"2024-01-16T00:00:00.000Z",formattedDate:"16 janvier 2024",tags:[{label:"docusaurus",permalink:"/blog/blog/tags/docusaurus"},{label:"github",permalink:"/blog/blog/tags/github"}],readingTime:1.945,hasTruncateMarker:!0,authors:[{name:"Florent B.",title:"Consultant IT Senior",url:"https://github.com/flobsx",imageURL:"https://github.com/flobsx.png",key:"flobsx"}],frontMatter:{title:"Blog personnel avec Docusaurus, Github Pages + Actions",authors:"flobsx",tags:["docusaurus","github"]},unlisted:!1},a={authorsImageUrls:[void 0]},u=[{value:"Pr\xe9requis",id:"pr\xe9requis",level:3}];function c(e){const n={code:"code",h1:"h1",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"L'objectif est de publier un blog sur Github Pages en utilisant Docusaurus et un d\xe9ploiement automatique.\nAfin de garder priv\xe9e les Issues et Pull Request, j'utilise deux d\xe9p\xf4ts distincts :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"personal-blog: D\xe9p\xf4t priv\xe9 contenant les sources, les actions, les issues et PR"}),"\n",(0,t.jsx)(n.li,{children:"flobsx.github.io: Le D\xe9p\xf4t public automatiquement reconstruit lors des update de personal-blog"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"pr\xe9requis",children:"Pr\xe9requis"}),"\n",(0,t.jsx)(n.p,{children:"Installer :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Node JS"}),"\n",(0,t.jsx)(n.li,{children:"Git"}),"\n",(0,t.jsx)(n.li,{children:"GH"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"cr\xe9er-le-projet-docusaurus",children:"Cr\xe9er le projet Docusaurus"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'npx create-docusaurus@latest personal-blog classic\ncd personal-blog\nnpm i\n\ngit init\ngit add .\ngit commit -m "first commit"\ngit barnch -M main\ngit remote add origin https://github.com/flobsx/personal-blog.git\ngit push -u origin main\n\ncode .\n'})}),"\n",(0,t.jsx)(n.h1,{id:"modifier-la-configuration",children:"Modifier la configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Ouvrir le fichier ",(0,t.jsx)(n.code,{children:"docusaurus.config.js"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const config = {\n  title: 'flobsx dev blog',\n  tagline: 'Vers l\\'infini et puis voil\xe0 \ud83d\ude80',\n  favicon: 'img/favicon.ico',\n\n  // Set the production url of your site here\n  url: 'https://flobsx.github.io',\n  // Set the /<baseUrl>/ pathname under which your site is served\n  // For GitHub pages deployment, it is often '/<projectName>/'\n  baseUrl: '/',\n\n  // GitHub pages deployment config.\n  // If you aren't using GitHub pages, you don't need these.\n  organizationName: 'flobsx', // Usually your GitHub org/user name.\n  projectName: 'flobsx.github.io', // Usually your repo name.\n  deploymentBranch: 'gh-pages',\n  trailingSlash: true,\n  [...]\n"})}),"\n",(0,t.jsx)(n.h1,{id:"d\xe9ploiement-automatique-sur-d\xe9p\xf4t-distant",children:"D\xe9ploiement automatique sur d\xe9p\xf4t distant"}),"\n",(0,t.jsx)(n.p,{children:"Pr\xe9parer les cl\xe9s de d\xe9ploiement :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ssh-keygen -t ed25519 -C "flobsx@gmail.com"\ngh auth refresh -h github.com -s admin:public_key\ngh repo deploy-key add ~/.ssh/id_ed25519.pub --allow-write --title "gh-action-deploy" --repo flobsx/flobsx.github.io\ngh secret set GH_PAGES_DEPLOY -R flobsx/personal-blog < ~/.ssh/id_ed25519\n'})}),"\n",(0,t.jsx)(n.p,{children:"Cr\xe9er le workflow :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mkdir .github\nmkdir .github/workflows\ncode .github/workflows/deploy.yml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yml",children:"name: Deploy to GitHub Pages\n\non:\n  pull_request:\n    branches: [main]\n  push:\n    branches: [main]\n\npermissions:\n  contents: write\n\njobs:\n  test-deploy:\n    if: github.event_name != 'push'\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n        with:\n          node-version: 18\n          cache: yarn\n      - name: Install dependencies\n        run: yarn install --frozen-lockfile\n      - name: Test build website\n        run: yarn build\n  deploy:\n    if: github.event_name != 'pull_request'\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n        with:\n          node-version: 18\n          cache: yarn\n      - uses: webfactory/ssh-agent@v0.5.0\n        with:\n          ssh-private-key: ${{ secrets.GH_PAGES_DEPLOY }}\n      - name: Deploy to GitHub Pages\n        env:\n          USE_SSH: true\n        run: |\n          git config --global user.email \"flobsx@gmail.com\"\n          git config --global user.name \"flobsx\"\n          yarn install --frozen-lockfile\n          yarn deploy\n"})}),"\n",(0,t.jsx)(n.h1,{id:"finalisation",children:"Finalisation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'yarn install\nGIT_USER=flobsx yarn deploy\n\ngit add .\ngit commit -m "ready to deploy"\ngit push -u origin main\n'})})]})}function d(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>r,a:()=>l});var t=s(7294);const i={},o=t.createContext(i);function l(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);